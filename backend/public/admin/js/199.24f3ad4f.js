"use strict";(globalThis["webpackChunksherlock_godjango_admin_ui"]=globalThis["webpackChunksherlock_godjango_admin_ui"]||[]).push([[199],{1199:(e,n,o)=>{o.r(n),o.d(n,{default:()=>B});var t=o(9835),l=o(499),a=o(6970);const u={class:"text-body1"},i={class:"text-subtitle2"},r=(0,t.aZ)({props:{group:null},setup(e){const n=e;return(e,o)=>{const l=(0,t.up)("q-icon"),r=(0,t.up)("q-card-section"),c=(0,t.up)("q-card");return(0,t.wg)(),(0,t.j4)(c,{class:"cursor-pointer"},{default:(0,t.w5)((()=>[(0,t.Wm)(r,null,{default:(0,t.w5)((()=>{var e;return[(0,t._)("div",u,(0,a.zw)(n.group.name),1),(0,t._)("div",i,[(0,t.Wm)(l,{name:"mdi-account-multiple",class:"q-mr-sm"}),(0,t._)("span",null,(0,a.zw)((null===(e=n.group.agents)||void 0===e?void 0:e.length)?n.group.agents.length:0)+" Agentes",1)])]})),_:1})])),_:1})}}});var c=o(4458),d=o(3190),s=o(2857),m=o(9984),p=o.n(m);const v=r,g=v;p()(r,"components",{QCard:c.Z,QCardSection:d.Z,QIcon:s.Z});var f=o(33),w=o(5304),y=function(e,n,o,t){function l(e){return e instanceof o?e:new o((function(n){n(e)}))}return new(o||(o=Promise))((function(o,a){function u(e){try{r(t.next(e))}catch(n){a(n)}}function i(e){try{r(t["throw"](e))}catch(n){a(n)}}function r(e){e.done?o(e.value):l(e.value).then(u,i)}r((t=t.apply(e,n||[])).next())}))};const h={class:"text-body1 text-center"},_=(0,t.aZ)({props:{group:null},emits:["add-agent","remove-agent","remove-group","update","cancel"],setup(e,{emit:n}){const o=e,u=(0,w.Ey)(w.cH),i=(0,f.GZ)(),r=(0,t.Fl)((()=>u.agents)),{group:c}=(0,l.BK)(o),d=(0,l.iH)();function s(){return y(this,void 0,void 0,(function*(){f.j7.loading();try{yield u.addAgentToGroup(d.value,c.value.id),n("add-agent")}catch(e){f.j7.axiosError(e,"No se pudo Agente el usuario")}f.j7.loading(!1)}))}function m(e){return y(this,void 0,void 0,(function*(){i.deleteDialog({title:"Eliminar Agente",message:"Va a eliminar un nuevo Agente del grupo",onOk:()=>y(this,void 0,void 0,(function*(){f.j7.loading();try{yield u.removeAgentFromGroup(e,c.value.id),n("remove-agent")}catch(o){f.j7.axiosError(o,"No se pudo eliminar el Agente")}f.j7.loading(!1)}))})}))}function p(){i.deleteDialog({title:"Eliminar Grupo",message:"¿Desea eliminar el grupo de agentes?",onOk:()=>y(this,void 0,void 0,(function*(){f.j7.loading();try{yield u.removeGroup(c.value.id),n("remove-group")}catch(e){f.j7.axiosError(e,"Error eliminando")}f.j7.loading(!1)}))})}return(e,o)=>{const u=(0,t.up)("q-icon"),i=(0,t.up)("q-card-section"),v=(0,t.up)("q-select"),g=(0,t.up)("q-item-section"),f=(0,t.up)("q-item"),w=(0,t.up)("q-list"),y=(0,t.up)("q-btn"),_=(0,t.up)("q-card-actions"),k=(0,t.up)("q-card");return(0,t.wg)(),(0,t.j4)(k,{class:"text-grey-9"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,null,{default:(0,t.w5)((()=>[(0,t._)("div",h,(0,a.zw)((0,l.SU)(c).name),1),(0,t._)("p",null,(0,a.zw)((0,l.SU)(c).description),1),(0,t._)("div",{class:"absolute-top-right q-pa-sm cursor-pointer",onClick:o[0]||(o[0]=e=>n("cancel"))},[(0,t.Wm)(u,{name:"mdi-close"})])])),_:1}),(0,t.Wm)(i,{class:"q-pa-sm"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{bordered:"",separator:""},{default:(0,t.w5)((()=>[1!==(0,l.SU)(c).id?((0,t.wg)(),(0,t.j4)(f,{key:0},{default:(0,t.w5)((()=>[(0,t.Wm)(g,null,{default:(0,t.w5)((()=>[(0,t.Wm)(v,{modelValue:d.value,"onUpdate:modelValue":o[1]||(o[1]=e=>d.value=e),options:(0,l.SU)(r),"emit-value":"","map-options":"","option-value":"id","option-label":"nick",label:"Añadir Agente",dense:""},null,8,["modelValue","options"])])),_:1}),1!==(0,l.SU)(c).id?((0,t.wg)(),(0,t.j4)(g,{key:0,avatar:"",class:"cursor-pointer",onClick:s},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{color:"positive",name:"mdi-plus"})])),_:1})):(0,t.kq)("",!0)])),_:1})):(0,t.kq)("",!0),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,l.SU)(c).agents,((e,n)=>((0,t.wg)(),(0,t.j4)(f,{key:`agent-list-${n}-${e.id}`},{default:(0,t.w5)((()=>[(0,t.Wm)(g,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,a.zw)(e.nick),1)])),_:2},1024),1!==(0,l.SU)(c).id?((0,t.wg)(),(0,t.j4)(g,{key:0,avatar:"",class:"cursor-pointer",onClick:n=>m(e.id)},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{color:"negative",name:"mdi-delete"})])),_:2},1032,["onClick"])):(0,t.kq)("",!0)])),_:2},1024)))),128))])),_:1})])),_:1}),(0,l.SU)(c).id>1?((0,t.wg)(),(0,t.j4)(_,{key:0},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{color:"negative",icon:"mdi-delete",label:"Eliminar Grupo",onClick:p})])),_:1})):(0,t.kq)("",!0)])),_:1})}}});var k=o(3246),q=o(490),Z=o(1233),b=o(215),W=o(1821),C=o(4455);const j=_,x=j;p()(_,"components",{QCard:c.Z,QCardSection:d.Z,QIcon:s.Z,QList:k.Z,QItem:q.Z,QItemSection:Z.Z,QSelect:b.Z,QCardActions:W.Z,QBtn:C.Z});var Q=o(1957),S=function(e,n,o,t){function l(e){return e instanceof o?e:new o((function(n){n(e)}))}return new(o||(o=Promise))((function(o,a){function u(e){try{r(t.next(e))}catch(n){a(n)}}function i(e){try{r(t["throw"](e))}catch(n){a(n)}}function r(e){e.done?o(e.value):l(e.value).then(u,i)}r((t=t.apply(e,n||[])).next())}))};const U=(0,t.aZ)({emits:["complete","cancel"],setup(e,{emit:n}){const o=(0,w.Ey)(w.cH),a=(0,l.iH)({name:"",description:""});function u(){return S(this,void 0,void 0,(function*(){try{yield o.createGroup(a.value),n("complete")}catch(e){f.j7.axiosError(e,"No se pudo guardar")}}))}return(e,o)=>{const l=(0,t.up)("q-input"),i=(0,t.up)("q-card-section"),r=(0,t.up)("q-btn"),c=(0,t.up)("q-card-actions"),d=(0,t.up)("q-form"),s=(0,t.up)("q-card");return(0,t.wg)(),(0,t.j4)(s,null,{default:(0,t.w5)((()=>[(0,t.Wm)(d,{onSubmit:(0,Q.iM)(u,["prevent"])},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{class:"q-gutter-y-sm"},{default:(0,t.w5)((()=>[(0,t.Wm)(l,{modelValue:a.value.name,"onUpdate:modelValue":o[0]||(o[0]=e=>a.value.name=e),required:"",type:"text",label:"Nombre del Grupo"},null,8,["modelValue"]),(0,t.Wm)(l,{modelValue:a.value.description,"onUpdate:modelValue":o[1]||(o[1]=e=>a.value.description=e),type:"textarea",label:"Descripción del Grupo"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,{oulined:"",color:"primary",icon:"mdi-cancel",label:"Cancelar",onClick:o[2]||(o[2]=e=>n("cancel"))}),(0,t.Wm)(r,{color:"primary",icon:"mdi-check",label:"Guardar",type:"submit"})])),_:1})])),_:1},8,["onSubmit"])])),_:1})}}});var V=o(8326),A=o(6611);const G=U,E=G;p()(U,"components",{QCard:c.Z,QForm:V.Z,QCardSection:d.Z,QInput:A.Z,QCardActions:W.Z,QBtn:C.Z});var H=function(e,n,o,t){function l(e){return e instanceof o?e:new o((function(n){n(e)}))}return new(o||(o=Promise))((function(o,a){function u(e){try{r(t.next(e))}catch(n){a(n)}}function i(e){try{r(t["throw"](e))}catch(n){a(n)}}function r(e){e.done?o(e.value):l(e.value).then(u,i)}r((t=t.apply(e,n||[])).next())}))};const D=(0,t._)("div",{class:"text-h6 text-center"},"Administrar Grupos",-1),I={class:"text-subtitle2"},z={class:"row q-col-gutter-sm"},F=(0,t.aZ)({setup(e){const n=(0,w.Ey)(w.cH),o=(0,l.iH)(!1),a=(0,l.iH)(!1),u=(0,l.iH)("a"),i=(0,t.Fl)((()=>n.groups)),r=(0,l.iH)();function c(){o.value=!1,a.value=!1,r.value=void 0}function d(e){c(),r.value=e,a.value=!0}function s(){return H(this,void 0,void 0,(function*(){yield n.list();const e=i.value.findIndex((e=>{var n;return e.id===(null===(n=r.value)||void 0===n?void 0:n.id)}));r.value=i.value[e],u.value=btoa(Date())}))}return(0,t.wF)((()=>{Promise.all([void n.list(),void n.listGroup()]).catch((e=>{f.j7.axiosError(e,"Error de red")}))})),(e,n)=>{const m=(0,t.up)("q-btn"),p=(0,t.up)("q-card-section"),v=(0,t.up)("q-card"),f=(0,t.up)("q-dialog"),w=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(w,{padding:""},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{class:"no-box-shadow"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[D,(0,t._)("div",I,[(0,t.Wm)(m,{color:"primary",class:"full-width",icon:"mdi-plus",label:"Nuevo Grupo",onClick:n[0]||(n[0]=e=>o.value=!0)})])])),_:1}),(0,l.SU)(i)?((0,t.wg)(),(0,t.j4)(p,{key:0},{default:(0,t.w5)((()=>[(0,t._)("div",z,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,l.SU)(i),((e,n)=>((0,t.wg)(),(0,t.iD)("div",{class:"col-xs-12 col-sm-6 col-md-4 col-lg-3",key:`group-${e.id}-${n}`},[(0,t.Wm)(g,{group:e,onClick:n=>d(e)},null,8,["group","onClick"])])))),128))])])),_:1})):(0,t.kq)("",!0)])),_:1}),(0,t.Wm)(f,{modelValue:o.value,"onUpdate:modelValue":n[1]||(n[1]=e=>o.value=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(E,{class:"full-width",onCancel:c,onComplete:c})])),_:1},8,["modelValue"]),(0,t.Wm)(f,{modelValue:a.value,"onUpdate:modelValue":n[2]||(n[2]=e=>a.value=e)},{default:(0,t.w5)((()=>[r.value?((0,t.wg)(),(0,t.j4)(x,{style:{"min-width":"20rem"},key:`d-key-${u.value}`,group:r.value,onAddAgent:s,onRemoveAgent:s,onRemoveGroup:c,onCancel:c},null,8,["group"])):(0,t.kq)("",!0)])),_:1},8,["modelValue"])])),_:1})}}});var N=o(9885),P=o(2074);const $=F,B=$;p()(F,"components",{QPage:N.Z,QCard:c.Z,QCardSection:d.Z,QBtn:C.Z,QDialog:P.Z})}}]);