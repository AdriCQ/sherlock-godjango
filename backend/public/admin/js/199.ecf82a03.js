"use strict";(self["webpackChunksherlock_godjango_admin_ui"]=self["webpackChunksherlock_godjango_admin_ui"]||[]).push([[199],{1199:(e,n,t)=>{t.r(n),t.d(n,{default:()=>B});var o=t(9835),l=t(499),a=t(6970);const u={class:"text-body1"},i={class:"text-subtitle2"},r=(0,o.aZ)({props:{group:null},setup(e){const n=e;return(e,t)=>{const l=(0,o.up)("q-icon"),r=(0,o.up)("q-card-section"),c=(0,o.up)("q-card");return(0,o.wg)(),(0,o.j4)(c,{class:"cursor-pointer"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>{var e;return[(0,o._)("div",u,(0,a.zw)(n.group.name),1),(0,o._)("div",i,[(0,o.Wm)(l,{name:"mdi-account-multiple",class:"q-mr-sm"}),(0,o._)("span",null,(0,a.zw)((null===(e=n.group.agents)||void 0===e?void 0:e.length)?n.group.agents.length:0)+" Agentes",1)])]})),_:1})])),_:1})}}});var c=t(4458),d=t(3190),s=t(2857),m=t(9984),p=t.n(m);const v=r,g=v;p()(r,"components",{QCard:c.Z,QCardSection:d.Z,QIcon:s.Z});var f=t(33),w=t(5304),y=function(e,n,t,o){function l(e){return e instanceof t?e:new t((function(n){n(e)}))}return new(t||(t=Promise))((function(t,a){function u(e){try{r(o.next(e))}catch(n){a(n)}}function i(e){try{r(o["throw"](e))}catch(n){a(n)}}function r(e){e.done?t(e.value):l(e.value).then(u,i)}r((o=o.apply(e,n||[])).next())}))};const _={class:"text-body1 text-center"},h=(0,o.aZ)({props:{group:null},emits:["add-agent","remove-agent","remove-group","update","cancel"],setup(e,{emit:n}){const t=e,u=(0,w.Ey)(w.cH),i=(0,f.GZ)(),r=(0,o.Fl)((()=>u.agents)),{group:c}=(0,l.BK)(t),d=(0,l.iH)();function s(){return y(this,void 0,void 0,(function*(){f.j7.loading();try{yield u.addAgentToGroup(d.value,c.value.id),n("add-agent")}catch(e){f.j7.axiosError(e,"No se pudo Agente el usuario")}f.j7.loading(!1)}))}function m(e){return y(this,void 0,void 0,(function*(){i.deleteDialog({title:"Eliminar Agente",message:"Va a eliminar un nuevo Agente del grupo",onOk:()=>y(this,void 0,void 0,(function*(){f.j7.loading();try{yield u.removeAgentFromGroup(e,c.value.id),n("remove-agent")}catch(t){f.j7.axiosError(t,"No se pudo eliminar el Agente")}f.j7.loading(!1)}))})}))}function p(){i.deleteDialog({title:"Eliminar Grupo",message:"¿Desea eliminar el grupo de agentes?",onOk:()=>y(this,void 0,void 0,(function*(){f.j7.loading();try{yield u.removeGroup(c.value.id),n("remove-group")}catch(e){f.j7.axiosError(e,"Error eliminando")}f.j7.loading(!1)}))})}return(e,t)=>{const u=(0,o.up)("q-icon"),i=(0,o.up)("q-card-section"),v=(0,o.up)("q-select"),g=(0,o.up)("q-item-section"),f=(0,o.up)("q-item"),w=(0,o.up)("q-list"),y=(0,o.up)("q-btn"),h=(0,o.up)("q-card-actions"),k=(0,o.up)("q-card");return(0,o.wg)(),(0,o.j4)(k,{class:"text-grey-9"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,null,{default:(0,o.w5)((()=>[(0,o._)("div",_,(0,a.zw)((0,l.SU)(c).name),1),(0,o._)("p",null,(0,a.zw)((0,l.SU)(c).description),1),(0,o._)("div",{class:"absolute-top-right q-pa-sm cursor-pointer",onClick:t[0]||(t[0]=e=>n("cancel"))},[(0,o.Wm)(u,{name:"mdi-close"})])])),_:1}),(0,o.Wm)(i,{class:"q-pa-sm"},{default:(0,o.w5)((()=>[(0,o.Wm)(w,{bordered:"",separator:""},{default:(0,o.w5)((()=>[1!==(0,l.SU)(c).id?((0,o.wg)(),(0,o.j4)(f,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,{modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=e=>d.value=e),options:(0,l.SU)(r),"emit-value":"","map-options":"","option-value":"id","option-label":"nick",label:"Añadir Agente",dense:""},null,8,["modelValue","options"])])),_:1}),1!==(0,l.SU)(c).id?((0,o.wg)(),(0,o.j4)(g,{key:0,avatar:"",class:"cursor-pointer",onClick:s},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{color:"positive",name:"mdi-plus"})])),_:1})):(0,o.kq)("",!0)])),_:1})):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,l.SU)(c).agents,((e,n)=>((0,o.wg)(),(0,o.j4)(f,{key:`agent-list-${n}-${e.id}`},{default:(0,o.w5)((()=>[(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e.nick),1)])),_:2},1024),1!==(0,l.SU)(c).id?((0,o.wg)(),(0,o.j4)(g,{key:0,avatar:"",class:"cursor-pointer",onClick:n=>m(e.id)},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{color:"negative",name:"mdi-delete"})])),_:2},1032,["onClick"])):(0,o.kq)("",!0)])),_:2},1024)))),128))])),_:1})])),_:1}),(0,l.SU)(c).id>1?((0,o.wg)(),(0,o.j4)(h,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{color:"negative",icon:"mdi-delete",label:"Eliminar Grupo",onClick:p})])),_:1})):(0,o.kq)("",!0)])),_:1})}}});var k=t(3246),q=t(490),Z=t(1233),W=t(215),b=t(1821),C=t(4455);const j=h,x=j;p()(h,"components",{QCard:c.Z,QCardSection:d.Z,QIcon:s.Z,QList:k.Z,QItem:q.Z,QItemSection:Z.Z,QSelect:W.Z,QCardActions:b.Z,QBtn:C.Z});var Q=t(1957),S=function(e,n,t,o){function l(e){return e instanceof t?e:new t((function(n){n(e)}))}return new(t||(t=Promise))((function(t,a){function u(e){try{r(o.next(e))}catch(n){a(n)}}function i(e){try{r(o["throw"](e))}catch(n){a(n)}}function r(e){e.done?t(e.value):l(e.value).then(u,i)}r((o=o.apply(e,n||[])).next())}))};const U=(0,o.aZ)({emits:["complete","cancel"],setup(e,{emit:n}){const t=(0,w.Ey)(w.cH),a=(0,l.iH)({name:"",description:""});function u(){return S(this,void 0,void 0,(function*(){try{yield t.createGroup(a.value),n("complete")}catch(e){f.j7.axiosError(e,"No se pudo guardar")}}))}return(e,t)=>{const l=(0,o.up)("q-input"),i=(0,o.up)("q-card-section"),r=(0,o.up)("q-btn"),c=(0,o.up)("q-card-actions"),d=(0,o.up)("q-form"),s=(0,o.up)("q-card");return(0,o.wg)(),(0,o.j4)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(d,{onSubmit:(0,Q.iM)(u,["prevent"])},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{class:"q-gutter-y-sm"},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{modelValue:a.value.name,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value.name=e),required:"",type:"text",label:"Nombre del Grupo"},null,8,["modelValue"]),(0,o.Wm)(l,{modelValue:a.value.description,"onUpdate:modelValue":t[1]||(t[1]=e=>a.value.description=e),type:"textarea",label:"Descripción del Grupo"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Wm)(r,{oulined:"",color:"primary",icon:"mdi-cancel",label:"Cancelar",onClick:t[2]||(t[2]=e=>n("cancel"))}),(0,o.Wm)(r,{color:"primary",icon:"mdi-check",label:"Guardar",type:"submit"})])),_:1})])),_:1},8,["onSubmit"])])),_:1})}}});var V=t(8326),A=t(6611);const G=U,E=G;p()(U,"components",{QCard:c.Z,QForm:V.Z,QCardSection:d.Z,QInput:A.Z,QCardActions:b.Z,QBtn:C.Z});var H=function(e,n,t,o){function l(e){return e instanceof t?e:new t((function(n){n(e)}))}return new(t||(t=Promise))((function(t,a){function u(e){try{r(o.next(e))}catch(n){a(n)}}function i(e){try{r(o["throw"](e))}catch(n){a(n)}}function r(e){e.done?t(e.value):l(e.value).then(u,i)}r((o=o.apply(e,n||[])).next())}))};const D=(0,o._)("div",{class:"text-h6 text-center"},"Administrar Grupos",-1),I={class:"text-subtitle2"},z={class:"row q-col-gutter-sm"},F=(0,o.aZ)({setup(e){const n=(0,w.Ey)(w.cH),t=(0,l.iH)(!1),a=(0,l.iH)(!1),u=(0,l.iH)("a"),i=(0,o.Fl)((()=>n.groups)),r=(0,l.iH)();function c(){t.value=!1,a.value=!1,r.value=void 0}function d(e){c(),r.value=e,a.value=!0}function s(){return H(this,void 0,void 0,(function*(){yield n.list();const e=i.value.findIndex((e=>{var n;return e.id===(null===(n=r.value)||void 0===n?void 0:n.id)}));r.value=i.value[e],u.value=btoa(Date())}))}return(0,o.wF)((()=>{Promise.all([void n.list(),void n.listGroup()]).catch((e=>{f.j7.axiosError(e,"Error de red")}))})),(e,n)=>{const m=(0,o.up)("q-btn"),p=(0,o.up)("q-card-section"),v=(0,o.up)("q-card"),f=(0,o.up)("q-dialog"),w=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(w,{padding:""},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{class:"no-box-shadow"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[D,(0,o._)("div",I,[(0,o.Wm)(m,{color:"primary",class:"full-width",icon:"mdi-plus",label:"Nuevo Grupo",onClick:n[0]||(n[0]=e=>t.value=!0)})])])),_:1}),(0,l.SU)(i)?((0,o.wg)(),(0,o.j4)(p,{key:0},{default:(0,o.w5)((()=>[(0,o._)("div",z,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,l.SU)(i),((e,n)=>((0,o.wg)(),(0,o.iD)("div",{class:"col-xs-12 col-sm-6 col-md-4 col-lg-3",key:`group-${e.id}-${n}`},[(0,o.Wm)(g,{group:e,onClick:n=>d(e)},null,8,["group","onClick"])])))),128))])])),_:1})):(0,o.kq)("",!0)])),_:1}),(0,o.Wm)(f,{modelValue:t.value,"onUpdate:modelValue":n[1]||(n[1]=e=>t.value=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(E,{class:"full-width",onCancel:c,onComplete:c})])),_:1},8,["modelValue"]),(0,o.Wm)(f,{modelValue:a.value,"onUpdate:modelValue":n[2]||(n[2]=e=>a.value=e)},{default:(0,o.w5)((()=>[r.value?((0,o.wg)(),(0,o.j4)(x,{style:{"min-width":"20rem"},key:`d-key-${u.value}`,group:r.value,onAddAgent:s,onRemoveAgent:s,onRemoveGroup:c,onCancel:c},null,8,["group"])):(0,o.kq)("",!0)])),_:1},8,["modelValue"])])),_:1})}}});var N=t(9885),P=t(2074);const $=F,B=$;p()(F,"components",{QPage:N.Z,QCard:c.Z,QCardSection:d.Z,QBtn:C.Z,QDialog:P.Z})}}]);