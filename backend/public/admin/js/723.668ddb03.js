"use strict";(self["webpackChunksherlock_godjango_admin_ui"]=self["webpackChunksherlock_godjango_admin_ui"]||[]).push([[723],{723:(e,t,a)=>{a.r(t),a.d(t,{default:()=>R});var l=a(9835),n=a(499),o=a(6970),i=a(5304),u=a(8910),s=a(28),c=a(685),r=a(1957),m=a(33),d=function(e,t,a,l){function n(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,o){function i(e){try{s(l.next(e))}catch(t){o(t)}}function u(e){try{s(l["throw"](e))}catch(t){o(t)}}function s(e){e.done?a(e.value):n(e.value).then(i,u)}s((l=l.apply(e,t||[])).next())}))};const p=(0,l.aZ)({props:{assignment:null},emits:["complete","cancel"],setup(e,{emit:t}){const a=e,o=(0,i.Ey)(i.VT),u=(0,n.iH)({id:0,created_at:"",name:"",position:m.he,status:0,contact:"",updated_at:""});function c(e){u.value.position=e}function p(){return d(this,void 0,void 0,(function*(){m.j7.loading();try{yield o.addCheckpoint(a.assignment.id,u.value),t("complete")}catch(e){m.j7.axiosError(e)}m.j7.loading(!1)}))}return(e,a)=>{const o=(0,l.up)("q-input"),i=(0,l.up)("q-card-section"),d=(0,l.up)("q-btn"),v=(0,l.up)("q-card-actions"),k=(0,l.up)("q-form"),w=(0,l.up)("q-card");return(0,l.wg)(),(0,l.j4)(w,null,{default:(0,l.w5)((()=>[(0,l.Wm)(k,{onSubmit:(0,r.iM)(p,["prevent"])},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{class:"q-gutter-y-sm"},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{modelValue:u.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>u.value.name=e),type:"text",label:"Nombre"},null,8,["modelValue"]),(0,l.Wm)(o,{modelValue:u.value.contact,"onUpdate:modelValue":a[1]||(a[1]=e=>u.value.contact=e),type:"text",label:"Contacto"},null,8,["modelValue"]),(0,l.Wm)(s.Z,{style:{height:"50vh"},onAddMarker:c,markers:[u.value.position],center:(0,n.SU)(m.he)},null,8,["markers","center"])])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"Cancelar",onClick:a[2]||(a[2]=e=>t("cancel")),color:"primary",outline:""}),(0,l.Wm)(d,{label:"Guardar",type:"submit",color:"primary"})])),_:1})])),_:1},8,["onSubmit"])])),_:1})}}});var v=a(4458),k=a(8326),w=a(3190),g=a(6611),f=a(1821),y=a(4455),h=a(9984),_=a.n(h);const b=p,C=b;_()(p,"components",{QCard:v.Z,QForm:k.Z,QCardSection:w.Z,QInput:g.Z,QCardActions:f.Z,QBtn:y.Z});var W=a(4587),q=a(4072),U=a(7506),S=a(4379),Z=function(e,t,a,l){function n(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,o){function i(e){try{s(l.next(e))}catch(t){o(t)}}function u(e){try{s(l["throw"](e))}catch(t){o(t)}}function s(e){e.done?a(e.value):n(e.value).then(i,u)}s((l=l.apply(e,t||[])).next())}))};const j={class:"row q-col-gutter-sm"},x={class:"col-xs-12 col-sm-6 col-lg-4"},Q={class:"text-h6"},V={key:0,class:"text-body1"},I={class:"text-subtitle1"},E={key:0,class:"text-subtitle2"},z={class:"text-subtitle2"},D={key:1},H=(0,l._)("div",{class:"text-body1 text-center"},"Checkpoints",-1),N=(0,l.Uk)("Todos"),A=(0,l.Uk)("Nuevo Checkpoint"),P={key:0,class:"col-sm-6 col-lg-8"},F=(0,l.aZ)({setup(e){const t=(0,i.Ey)(i.VT),a=(0,i.Ey)(i.cH),r=(0,m.GZ)(),d=(0,u.yj)(),p=(0,n.iH)(0),v=(0,l.Fl)((()=>{if(y.value)return t.getById(p.value);const e=a.assignments.findIndex((e=>e.id===p.value));return a.assignments[e]})),k=(0,n.iH)(),w=(0,l.Fl)((()=>{var e,t;const a=[];return k.value?[(0,W.latLng)(k.value.position.lat,k.value.position.lng)]:(null===(t=null===(e=v.value)||void 0===e?void 0:e.checkpoints)||void 0===t||t.forEach((e=>{a.push((0,W.latLng)(e.position.lat,e.position.lng))})),a)})),g=(0,n.iH)(!1),f=(0,n.iH)(!1),y=(0,l.Fl)((()=>d.name===q.I.ADMIN_ASSIGNMENT)),h=(0,l.Fl)((()=>U.ZP.is.mobile)),_=(0,n.iH)(15);function b(){g.value=!1,f.value=!1}function F(e){y.value||S.$router.push({name:q.I.AGENT_CHECKPOINT,params:{id:e}})}function T(e){r.deleteDialog({message:"Desea eliminar el checkpoint?",onOk:()=>Z(this,void 0,void 0,(function*(){m.j7.loading();try{yield t.removeCheckpoint(e.assignment_id,e.id)}catch(a){m.j7.axiosError(a,"No se pudo eliminar")}m.j7.loading(!1)})),title:"Eliminar Checkpoint"})}return(0,l.wF)((()=>{d.params&&d.params.id&&(p.value=Number(d.params.id))})),(e,t)=>{const a=(0,l.up)("q-btn"),i=(0,l.up)("q-chip"),u=(0,l.up)("q-card-section"),r=(0,l.up)("q-icon"),m=(0,l.up)("q-item-section"),d=(0,l.up)("q-item"),p=(0,l.up)("q-item-label"),W=(0,l.up)("q-avatar"),q=(0,l.up)("q-list"),U=(0,l.up)("q-card"),S=(0,l.up)("q-dialog"),Z=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(Z,{padding:""},{default:(0,l.w5)((()=>[(0,n.SU)(v)?((0,l.wg)(),(0,l.j4)(U,{key:0,class:"no-box-shadow"},{default:(0,l.w5)((()=>[(0,l._)("div",j,[(0,l._)("div",x,[(0,l.Wm)(u,{class:"q-gutter-y-sm"},{default:(0,l.w5)((()=>[(0,l._)("div",Q,(0,o.zw)((0,n.SU)(v).name),1),(0,n.SU)(y)?((0,l.wg)(),(0,l.iD)("div",V,[(0,l.Wm)(a,{color:"primary",icon:"mdi-pencil",label:"Administrar",class:"full-width",onClick:t[0]||(t[0]=e=>f.value=!0)})])):(0,l.kq)("",!0),(0,l._)("div",I,[(0,l.Wm)(i,{class:"glossy",icon:0===(0,n.SU)(v).status?"mdi-clock":"mdi-check",label:0===(0,n.SU)(v).status?"En Progreso":"Completado",color:0===(0,n.SU)(v).status?"":"positive"},null,8,["icon","label","color"])])])),_:1}),(0,l.Wm)(u,null,{default:(0,l.w5)((()=>{var e;return[(0,n.SU)(v).agent?((0,l.wg)(),(0,l.iD)("p",E,[(0,l.Wm)(r,{name:"mdi-account",class:"q-mr-sm"}),(0,l.Uk)(" "+(0,o.zw)(null===(e=(0,n.SU)(v).agent)||void 0===e?void 0:e.nick),1)])):(0,l.kq)("",!0),(0,l._)("p",z," DescripciÃ³n: "+(0,o.zw)((0,n.SU)(v).description),1),(0,n.SU)(v).observations?((0,l.wg)(),(0,l.iD)("p",D," Observaciones: "+(0,o.zw)((0,n.SU)(v).observations),1)):(0,l.kq)("",!0)]})),_:1}),(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[H,(0,l.Wm)(q,{bordered:"",class:"q-mt-sm"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{clickable:"",onClick:t[1]||(t[1]=e=>k.value=void 0)},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{avatar:""},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{name:"mdi-map-marker"})])),_:1}),(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[N])),_:1})])),_:1}),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,n.SU)(v).checkpoints,((e,t)=>((0,l.wg)(),(0,l.j4)(d,{key:`checkpoint-${e.id}-index-${t}`},{default:(0,l.w5)((()=>[(0,n.SU)(h)?((0,l.wg)(),(0,l.j4)(m,{key:0,class:"cursor-pointer",avatar:"",onClick:t=>F(e.id)},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{name:"mdi-eye"})])),_:2},1032,["onClick"])):((0,l.wg)(),(0,l.j4)(m,{key:1,class:"cursor-pointer",avatar:"",onClick:t=>k.value=e},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{name:"mdi-map-marker"})])),_:2},1032,["onClick"])),(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.name),1)])),_:2},1024),(0,l.Wm)(p,{caption:"",lines:"2"},{default:(0,l.w5)((()=>[0===e.status?((0,l.wg)(),(0,l.j4)(i,{key:0,class:"glossy",size:"sm",icon:"mdi-clock",label:"Pendiente"})):((0,l.wg)(),(0,l.j4)(i,{key:1,class:"glossy",size:"sm",icon:"mdi-check",label:"Completado"}))])),_:2},1024)])),_:2},1024),(0,n.SU)(y)?((0,l.wg)(),(0,l.j4)(m,{key:2,avatar:"",class:"cursor-pointer",onClick:t=>T(e)},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{name:"mdi-delete",color:"negative"})])),_:2},1032,["onClick"])):(0,l.kq)("",!0)])),_:2},1024)))),128)),(0,n.SU)(y)?((0,l.wg)(),(0,l.j4)(d,{key:0,clickable:"",onClick:t[2]||(t[2]=e=>g.value=!0)},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{top:"",avatar:""},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{color:"positive","text-color":"white",icon:"mdi-plus",size:"sm"})])),_:1}),(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[A])),_:1})])),_:1})])),_:1})):(0,l.kq)("",!0)])),_:1})])),_:1})]),(0,n.SU)(h)?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",P,[(0,l.Wm)(s.Z,{readonly:"",markers:(0,n.SU)(w),center:(0,n.SU)(w)[0],zoom:_.value,onUpdateZoom:t[3]||(t[3]=e=>_.value=e)},null,8,["markers","center","zoom"])]))])])),_:1})):(0,l.kq)("",!0),(0,l.Wm)(S,{modelValue:f.value,"onUpdate:modelValue":t[4]||(t[4]=e=>f.value=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(c.Z,{style:{"min-width":"20rem"},assignment:(0,n.SU)(v),onCancel:b,onComplete:b},null,8,["assignment"])])),_:1},8,["modelValue"]),(0,l.Wm)(S,{modelValue:g.value,"onUpdate:modelValue":t[5]||(t[5]=e=>g.value=e)},{default:(0,l.w5)((()=>[(0,n.SU)(v)?((0,l.wg)(),(0,l.j4)(C,{key:0,style:{"min-width":"20rem"},assignment:(0,n.SU)(v),onCancel:b,onComplete:b},null,8,["assignment"])):(0,l.kq)("",!0)])),_:1},8,["modelValue"])])),_:1})}}});var T=a(9885),G=a(7691),L=a(2857),M=a(3246),B=a(490),O=a(1233),$=a(3115),K=a(1357),Y=a(2074);const J=F,R=J;_()(F,"components",{QPage:T.Z,QCard:v.Z,QCardSection:w.Z,QBtn:y.Z,QChip:G.Z,QIcon:L.Z,QList:M.Z,QItem:B.Z,QItemSection:O.Z,QItemLabel:$.Z,QAvatar:K.Z,QDialog:Y.Z})}}]);