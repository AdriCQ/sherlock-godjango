"use strict";(globalThis["webpackChunksherlock_godjango_admin_ui"]=globalThis["webpackChunksherlock_godjango_admin_ui"]||[]).push([[842],{8842:(e,l,t)=>{t.r(l),t.d(l,{default:()=>z});var a=t(9835),n=t(499),o=t(6970),i=t(4587),u=t(4880),c=t(33),r=t(5304),d=t(8910),m=t(4072),s=function(e,l,t,a){function n(e){return e instanceof t?e:new t((function(l){l(e)}))}return new(t||(t=Promise))((function(t,o){function i(e){try{c(a.next(e))}catch(l){o(l)}}function u(e){try{c(a["throw"](e))}catch(l){o(l)}}function c(e){e.done?t(e.value):n(e.value).then(i,u)}c((a=a.apply(e,l||[])).next())}))};const p=(0,a._)("div",{class:"text-h6 text-center"},"Tarea Actual",-1),v=(0,a.Uk)("Mi Posicion"),f=(0,a.aZ)({setup(e){delete i.Icon.Default.prototype._getIconUrl,i.Icon.Default.mergeOptions({iconRetinaUrl:t(2420),iconUrl:t(6667),shadowUrl:t(6458)});const l='&copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap</a> contributors',f="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",h=(0,r.Ey)(r.cH),g=(0,d.tv)(),w=(0,a.Fl)((()=>h.assignments)),k=(0,n.iH)(c.he),y=(0,a.Fl)((()=>r.Rl.currentPosition)),_=(0,n.iH)(!0),W=(0,n.iH)(!1),b=(0,n.iH)([]),U=(0,n.iH)({multiple:!1,zoom:{max:18,min:6}}),q=(0,n.iH)(10);function C(e){e&&g.push({name:m.I.AGENT_CHECKPOINT,params:{id:e}})}function x(e){k.value=e}function Z(e){q.value=e}function H(e){const l=b.value.findIndex((l=>{var t,a;return(null===(t=l.checkpoint)||void 0===t?void 0:t.id)===(null===(a=e.checkpoint)||void 0===a?void 0:a.id)}));l>=0&&(b.value[l].visible=!b.value[l].visible)}return(0,a.wF)((()=>s(this,void 0,void 0,(function*(){let e;yield h.listAssignments(),w.value.forEach((l=>{var t;(null===(t=l.checkpoints)||void 0===t?void 0:t.length)&&l.checkpoints.forEach((l=>{l.status||(e=(0,i.latLng)(l.position.lat,l.position.lng),e.checkpoint=l,e.visible=!0,b.value.push(e))}))})),b.value.length&&(k.value=b.value[0])})))),(e,t)=>{const i=(0,a.up)("q-card-section"),c=(0,a.up)("q-btn"),r=(0,a.up)("q-card"),d=(0,a.up)("q-item-label"),m=(0,a.up)("q-item-section"),s=(0,a.up)("q-icon"),h=(0,a.up)("q-item"),g=(0,a.up)("q-list"),w=(0,a.up)("q-card-actions"),Q=(0,a.up)("q-dialog"),z=(0,a.up)("q-page"),I=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(z,{padding:""},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{class:"full-width",style:{height:"80vh"}},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{class:"q-pa-xs"},{default:(0,a.w5)((()=>[p])),_:1}),((0,a.wg)(),(0,a.j4)((0,n.SU)(u.iA),{ref:"map",id:"map--page-managerleaflet",class:"full-heigth",zoom:Number(q.value),center:k.value,"max-zoom":U.value.zoom.max,"onUpdate:center":x,"onUpdate:zoom":Z,key:`map-key-${q.value}-${k.value.lat}-${k.value.lng}`},{default:(0,a.w5)((()=>[(0,a.Wm)((0,n.SU)(u.Hw),{url:f,attribution:l}),b.value.length?((0,a.wg)(),(0,a.j4)((0,n.SU)(u.oJ),{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{color:"white","text-color":"dark",icon:"mdi-eye",onClick:t[0]||(t[0]=e=>W.value=!0)})])),_:1})):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(b.value,((e,l)=>((0,a.wg)(),(0,a.iD)(a.HY,{key:`marker-${l}`},[e.visible?((0,a.wg)(),(0,a.j4)((0,n.SU)(u.$R),{key:0,"lat-lng":e,onClick:l=>{var t;return C(null===(t=e.checkpoint)||void 0===t?void 0:t.id)}},null,8,["lat-lng","onClick"])):(0,a.kq)("",!0)],64)))),128)),_.value&&(0,n.SU)(y)?((0,a.wg)(),(0,a.j4)((0,n.SU)(u.$R),{key:1,"lat-lng":(0,n.SU)(y)},null,8,["lat-lng"])):(0,a.kq)("",!0)])),_:1},8,["zoom","center","max-zoom"]))])),_:1}),(0,a.Wm)(Q,{modelValue:W.value,"onUpdate:modelValue":t[2]||(t[2]=e=>W.value=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{class:"no-box-shadow",style:{"min-width":"20rem"}},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{bordered:""},{default:(0,a.w5)((()=>[(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[v])),_:1})])),_:1}),(0,a.Wm)(m,{avatar:"",onClick:t[1]||(t[1]=e=>_.value=!_.value)},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{color:"primary",name:_.value?"mdi-eye":"mdi-eye-off"},null,8,["name"])])),_:1})])),_:1}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(b.value,((e,l)=>{var t;return(0,a.wg)(),(0,a.j4)(h,{key:`mlistas-${null===(t=e.checkpoint)||void 0===t?void 0:t.id}-key-${l}`},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>{var l;return[(0,a.Uk)((0,o.zw)(null===(l=e.checkpoint)||void 0===l?void 0:l.name),1)]})),_:2},1024),(0,a.Wm)(d,{caption:"",lines:"2"},{default:(0,a.w5)((()=>{var l;return[(0,a.Uk)((0,o.zw)(0===(null===(l=e.checkpoint)||void 0===l?void 0:l.status)?"Pendiente":"Completado"),1)]})),_:2},1024)])),_:2},1024),(0,a.Wm)(m,{avatar:"",onClick:l=>H(e)},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{color:"primary",name:e.visible?"mdi-eye":"mdi-eye-off"},null,8,["name"])])),_:2},1032,["onClick"])])),_:2},1024)})),128))])),_:1})])),_:1}),(0,a.Wm)(w,{align:"right"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(c,{flat:"",label:"Aceptar",color:"primary"},null,512),[[I]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}}});var h=t(9885),g=t(4458),w=t(3190),k=t(4455),y=t(2074),_=t(3246),W=t(490),b=t(1233),U=t(3115),q=t(2857),C=t(1821),x=t(2146),Z=t(9984),H=t.n(Z);const Q=f,z=Q;H()(f,"components",{QPage:h.Z,QCard:g.Z,QCardSection:w.Z,QBtn:k.Z,QDialog:y.Z,QList:_.Z,QItem:W.Z,QItemSection:b.Z,QItemLabel:U.Z,QIcon:q.Z,QCardActions:C.Z}),H()(f,"directives",{ClosePopup:x.Z})}}]);