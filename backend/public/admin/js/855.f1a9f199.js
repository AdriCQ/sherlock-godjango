"use strict";(self["webpackChunksherlock_godjango_admin_ui"]=self["webpackChunksherlock_godjango_admin_ui"]||[]).push([[855],{8855:(e,o,a)=>{a.r(o),a.d(o,{default:()=>N});var l=a(9835),n=a(499),r=a(33),i=a(5304),t=a(6970),u=function(e,o,a,l){function n(e){return e instanceof a?e:new a((function(o){o(e)}))}return new(a||(a=Promise))((function(a,r){function i(e){try{u(l.next(e))}catch(o){r(o)}}function t(e){try{u(l["throw"](e))}catch(o){r(o)}}function u(e){e.done?a(e.value):n(e.value).then(i,t)}u((l=l.apply(e,o||[])).next())}))};const s={class:"absolute-top-right q-pa-xs cursor-pointer"},d={class:"text-body1"},m={class:"text-body2"},c={class:"text-body2"},p={class:"text-body2"},v=(0,l.aZ)({props:{user:null},emits:["remove","request-edit"],setup(e,{emit:o}){const a=e,v=(0,r.GZ)(),{user:f}=(0,n.BK)(a);function w(){return u(this,void 0,void 0,(function*(){v.deleteDialog({title:"Eliminar usuario",message:"Desea eliminar el usuario?",onOk:()=>u(this,void 0,void 0,(function*(){try{yield i.bR.remove(f.value.id),o("remove",f.value.id)}catch(e){r.j7.axiosError(e,"No se pudo eliminar el usuario")}}))})}))}return(e,a)=>{const r=(0,l.up)("q-icon"),i=(0,l.up)("q-card-section"),u=(0,l.up)("q-card");return(0,l.wg)(),(0,l.j4)(u,null,{default:(0,l.w5)((()=>[(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l._)("div",s,[(0,l._)("div",{onClick:w},[(0,l.Wm)(r,{name:"mdi-delete",color:"negative"})]),(0,l._)("div",{onClick:a[0]||(a[0]=e=>o("request-edit"))},[(0,l.Wm)(r,{name:"mdi-pencil",color:"primary"})])]),(0,l._)("div",d,(0,t.zw)((0,n.SU)(f).name),1),(0,l._)("div",m,[(0,l.Wm)(r,{name:"mdi-email-outline",class:"q-mr-sm"}),(0,l.Uk)((0,t.zw)((0,n.SU)(f).email),1)]),(0,l._)("div",c,[(0,l.Wm)(r,{name:"mdi-phone",class:"q-mr-sm"}),(0,l.Uk)((0,t.zw)((0,n.SU)(f).phone),1)]),(0,l._)("div",p,[(0,l.Wm)(r,{name:"mdi-account-settings",class:"q-mr-sm"}),(0,l.Uk)((0,t.zw)((0,n.SU)(f).role.display_name),1)])])),_:1})])),_:1})}}});var f=a(4458),w=a(3190),h=a(2857),y=a(9984),_=a.n(y);const g=v,q=g;_()(v,"components",{QCard:f.Z,QCardSection:w.Z,QIcon:h.Z});var U=a(1957),b=a(4519),W=a(6415),C=function(e,o,a,l){function n(e){return e instanceof a?e:new a((function(o){o(e)}))}return new(a||(a=Promise))((function(a,r){function i(e){try{u(l.next(e))}catch(o){r(o)}}function t(e){try{u(l["throw"](e))}catch(o){r(o)}}function u(e){e.done?a(e.value):n(e.value).then(i,t)}u((l=l.apply(e,o||[])).next())}))};const Z=(0,l.aZ)({props:{user:null},emits:["form-complete","cancel"],setup(e,{emit:o}){const a=e,u=(0,i.Ey)(i.Tc),s=(0,n.iH)({email:"",name:"",phone:"",password:"",password_confirmation:"",role_id:2}),d=(0,l.Fl)((()=>!!a.user)),m=(0,l.Fl)((()=>u.roles.filter((e=>"admin"!==e.name)))),c=(0,b.ZP)({email:{required:W.BM.withMessage("El email es necesario",W.C1),email:W.BM.withMessage("El email no es válido",W.Do)},phone:{required:W.BM.withMessage("El telefono es necesario",W.C1)},name:{required:W.BM.withMessage("Necesitamos su nombre",W.C1)}},s);function p(){var e;return C(this,void 0,void 0,(function*(){if(yield c.value.$validate())try{a.user?yield u.update(null===(e=a.user)||void 0===e?void 0:e.id,s.value):yield u.create(s.value),o("form-complete"),r.j7.success(["Usuario Guardado"])}catch(l){r.j7.axiosError(l,"No se pudo guardar el usuario")}}))}return(0,l.wF)((()=>C(this,void 0,void 0,(function*(){m.value.length||(yield u.listRoles()),a.user?s.value={email:a.user.email,name:a.user.name,password:void 0,password_confirmation:void 0,phone:a.user.phone,role_id:a.user.role.id}:s.value={email:"",name:"",password:"",password_confirmation:"",phone:"",role_id:2}})))),(e,a)=>{const r=(0,l.up)("q-input"),i=(0,l.up)("q-select"),u=(0,l.up)("q-card-section"),v=(0,l.up)("q-btn"),f=(0,l.up)("q-card-actions"),w=(0,l.up)("q-form"),h=(0,l.up)("q-card");return(0,l.wg)(),(0,l.j4)(h,null,{default:(0,l.w5)((()=>[(0,l.Wm)(w,{onSubmit:(0,U.iM)(p,["prevent"])},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{class:"q-gutter-y-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{modelValue:s.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>s.value.name=e),type:"text",label:"Nombre",name:"name",error:(0,n.SU)(c).name.$error,"bottom-slots":""},{error:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,n.SU)(c).name.$errors,(e=>((0,l.wg)(),(0,l.iD)("div",{key:e.$uid},(0,t.zw)(e.$message),1)))),128))])),_:1},8,["modelValue","error"]),(0,l.Wm)(r,{name:"email",modelValue:s.value.email,"onUpdate:modelValue":a[1]||(a[1]=e=>s.value.email=e),type:"email",label:"Email",error:(0,n.SU)(c).email.$error,"bottom-slots":"",readonly:(0,n.SU)(d)},{error:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,n.SU)(c).email.$errors,(e=>((0,l.wg)(),(0,l.iD)("div",{key:e.$uid},(0,t.zw)(e.$message),1)))),128))])),_:1},8,["modelValue","error","readonly"]),(0,l.Wm)(r,{name:"phone",modelValue:s.value.phone,"onUpdate:modelValue":a[2]||(a[2]=e=>s.value.phone=e),type:"tel",label:"Teléfono","bottom-slots":"",error:(0,n.SU)(c).phone.$error},{error:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,n.SU)(c).phone.$errors,(e=>((0,l.wg)(),(0,l.iD)("div",{key:e.$uid},(0,t.zw)(e.$message),1)))),128))])),_:1},8,["modelValue","error"]),(0,l.Wm)(i,{modelValue:s.value.role_id,"onUpdate:modelValue":a[3]||(a[3]=e=>s.value.role_id=e),options:(0,n.SU)(m),"emit-value":"","map-options":"","option-label":"display_name","option-value":"id",label:"Permisos"},null,8,["modelValue","options"]),(0,l.Wm)(r,{name:"password",modelValue:s.value.password,"onUpdate:modelValue":a[4]||(a[4]=e=>s.value.password=e),type:"password",label:"Contraseña",required:!(0,n.SU)(d)},null,8,["modelValue","required"]),(0,l.Wm)(r,{name:"password_confirmation",modelValue:s.value.password_confirmation,"onUpdate:modelValue":a[5]||(a[5]=e=>s.value.password_confirmation=e),type:"password",label:"Repita Contraseña",required:!(0,n.SU)(d)},null,8,["modelValue","required"])])),_:1}),(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v,{color:"primary",outline:"",label:"Cerrar",icon:"mdi-close",onClick:a[6]||(a[6]=e=>o("cancel"))}),(0,l.Wm)(v,{color:"primary",icon:"mdi-check",label:"Guardar",type:"submit"})])),_:1})])),_:1},8,["onSubmit"])])),_:1})}}});var S=a(8326),V=a(6611),k=a(215),x=a(1821),Q=a(4455);const D=Z,$=D;_()(Z,"components",{QCard:f.Z,QForm:S.Z,QCardSection:w.Z,QInput:V.Z,QSelect:k.Z,QCardActions:x.Z,QBtn:Q.Z});var E=function(e,o,a,l){function n(e){return e instanceof a?e:new a((function(o){o(e)}))}return new(a||(a=Promise))((function(a,r){function i(e){try{u(l.next(e))}catch(o){r(o)}}function t(e){try{u(l["throw"](e))}catch(o){r(o)}}function u(e){e.done?a(e.value):n(e.value).then(i,t)}u((l=l.apply(e,o||[])).next())}))};const j=(0,l._)("div",{class:"text-h6 text-center"},"Administrar Usuarios",-1),M={class:"text-subtitle2"},P={class:"row q-col-gutter-sm"},z=(0,l.aZ)({setup(e){const o=(0,r.GZ)(),a=(0,i.Ey)(i.Tc),t=(0,n.iH)(!1),u=(0,n.Fl)((()=>a.allUsers)),s=(0,n.iH)();function d(){console.log("Close Dialog"),t.value=!1,s.value=void 0}function m(e){o.deleteDialog({title:"Editar Usuario",message:"Desea editar el usuario?",onOk:()=>{s.value=e,t.value=!0}})}function c(){return E(this,void 0,void 0,(function*(){try{yield a.list()}catch(e){r.j7.axiosError(e,"No se pudo listar los usuarios")}}))}function p(){return E(this,void 0,void 0,(function*(){yield c()}))}function v(e){return E(this,void 0,void 0,(function*(){yield c(),e()}))}return(0,l.wF)((()=>{v((()=>{console.log("Users Page")}))})),(e,o)=>{const a=(0,l.up)("q-btn"),r=(0,l.up)("q-card-section"),i=(0,l.up)("q-card"),c=(0,l.up)("q-dialog"),v=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(v,{padding:""},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{class:"no-box-shadow"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[j,(0,l._)("div",M,[(0,l.Wm)(a,{color:"primary",class:"full-width",icon:"mdi-plus",label:"Nuevo Usuario",onClick:o[0]||(o[0]=e=>t.value=!0)})])])),_:1}),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",P,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,n.SU)(u),(e=>((0,l.wg)(),(0,l.iD)("div",{class:"col-xs-12 col-sm-6 col-md-4",key:`user-${e.id}`},[(0,l.Wm)(q,{user:e,onRemove:p,onRequestEdit:o=>m(e)},null,8,["user","onRequestEdit"])])))),128))])])),_:1})])),_:1}),(0,l.Wm)(c,{modelValue:t.value,"onUpdate:modelValue":o[1]||(o[1]=e=>t.value=e),class:"q-pa-md"},{default:(0,l.w5)((()=>[(0,l.Wm)($,{style:{"min-width":"20rem"},user:s.value,onFormComplete:d,onCancel:d},null,8,["user"])])),_:1},8,["modelValue"])])),_:1})}}});var B=a(699),F=a(9885),H=a(2074);const R=z,N=R;_()(z,"components",{QPullToRefresh:B.Z,QPage:F.Z,QCard:f.Z,QCardSection:w.Z,QBtn:Q.Z,QDialog:H.Z})}}]);