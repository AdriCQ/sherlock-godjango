"use strict";(self["webpackChunksherlock_godjango_admin_ui"]=self["webpackChunksherlock_godjango_admin_ui"]||[]).push([[996],{2996:(e,a,l)=>{l.r(a),l.d(a,{default:()=>T});var n=l(9835),t=l(499),o=l(33),u=l(5304),i=l(1957),r=function(e,a,l,n){function t(e){return e instanceof l?e:new l((function(a){a(e)}))}return new(l||(l=Promise))((function(l,o){function u(e){try{r(n.next(e))}catch(a){o(a)}}function i(e){try{r(n["throw"](e))}catch(a){o(a)}}function r(e){e.done?l(e.value):t(e.value).then(u,i)}r((n=n.apply(e,a||[])).next())}))};const c=(0,n.aZ)({props:{agent:null},emits:["cancel","complete"],setup(e,{emit:a}){const l=e,c=(0,u.Ey)(u.cH),s=(0,u.Ey)(u.Tc),d=(0,n.Fl)((()=>c.groups)),m=(0,t.iH)(),p=(0,t.iH)(),g=(0,n.Fl)((()=>s.allUsers));function v(){return r(this,void 0,void 0,(function*(){if(o.j7.loading(),m.value){try{l.agent?yield c.update(l.agent.id,m.value):(m.value.user_id=p.value,yield c.create(m.value)),a("complete")}catch(e){o.j7.axiosError(e,"No se guardo el agente")}o.j7.loading(!1)}}))}return(0,n.wF)((()=>{l.agent?(m.value={address:l.agent.address,agent_group_id:l.agent.agent_group_id,bussy:l.agent.bussy,nick:l.agent.nick,others:l.agent.others,user_id:l.agent.user_id},p.value=l.agent.user_id):m.value={address:"",agent_group_id:1,user_id:0,bussy:!1,nick:"",others:""}})),(e,o)=>{const u=(0,n.up)("q-select"),r=(0,n.up)("q-input"),c=(0,n.up)("q-card-section"),s=(0,n.up)("q-btn"),f=(0,n.up)("q-card-actions"),y=(0,n.up)("q-form"),h=(0,n.up)("q-card");return(0,n.wg)(),(0,n.j4)(h,null,{default:(0,n.w5)((()=>[m.value?((0,n.wg)(),(0,n.j4)(y,{key:0,onSubmit:(0,i.iM)(v,["prevent"])},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{class:"q-gutter-y-sm"},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{modelValue:p.value,"onUpdate:modelValue":o[0]||(o[0]=e=>p.value=e),options:(0,t.SU)(g),label:"Usuario","emit-value":"","map-options":"","option-label":"name","option-value":"id",readonly:!!l.agent},null,8,["modelValue","options","readonly"]),(0,n.Wm)(r,{modelValue:m.value.nick,"onUpdate:modelValue":o[1]||(o[1]=e=>m.value.nick=e),required:"",type:"text",label:"Nick"},null,8,["modelValue"]),(0,n.Wm)(r,{modelValue:m.value.address,"onUpdate:modelValue":o[2]||(o[2]=e=>m.value.address=e),required:"",type:"text",label:"DirecciÃ³n"},null,8,["modelValue"]),(0,n.Wm)(u,{required:"",modelValue:m.value.agent_group_id,"onUpdate:modelValue":o[3]||(o[3]=e=>m.value.agent_group_id=e),options:(0,t.SU)(d),label:"Grupo","map-options":"","emit-value":"","option-label":"name","option-value":"id"},null,8,["modelValue","options"]),(0,n.Wm)(r,{modelValue:m.value.others,"onUpdate:modelValue":o[4]||(o[4]=e=>m.value.others=e),type:"textarea",label:"Observaciones"},null,8,["modelValue"])])),_:1}),(0,n.Wm)(f,null,{default:(0,n.w5)((()=>[(0,n.Wm)(s,{color:"primary",icon:"mdi-close",label:"Cerrar",outline:"",onClick:o[5]||(o[5]=e=>a("cancel"))}),(0,n.Wm)(s,{color:"primary",icon:"mdi-check",label:"Guardar",type:"submit"})])),_:1})])),_:1},8,["onSubmit"])):(0,n.kq)("",!0)])),_:1})}}});var s=l(4458),d=l(8326),m=l(3190),p=l(215),g=l(6611),v=l(1821),f=l(4455),y=l(9984),h=l.n(y);const w=c,b=w;h()(c,"components",{QCard:s.Z,QForm:d.Z,QCardSection:m.Z,QSelect:p.Z,QInput:g.Z,QCardActions:v.Z,QBtn:f.Z});var _=l(6970);const q={class:"absolute-top-right q-pa-xs cursor-pointer"},k={class:"text-body2"},V=(0,n.aZ)({props:{agent:null},emits:["request-edit"],setup(e,{emit:a}){const l=e;return(e,t)=>{const o=(0,n.up)("q-icon"),u=(0,n.up)("q-card-section"),i=(0,n.up)("q-chip"),r=(0,n.up)("q-card-actions"),c=(0,n.up)("q-card");return(0,n.wg)(),(0,n.j4)(c,null,{default:(0,n.w5)((()=>[(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[(0,n._)("div",q,[(0,n._)("div",{onClick:t[0]||(t[0]=e=>a("request-edit"))},[(0,n.Wm)(o,{name:"mdi-pencil",color:"primary"})])]),(0,n._)("div",k,(0,_.zw)(l.agent.nick),1)])),_:1}),(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(i,{size:"sm",class:"glossy",color:l.agent.bussy?"":"info",icon:l.agent.bussy?"mdi-cancel":"mdi-check",label:l.agent.bussy?"Ocupado":"Disponible"},null,8,["color","icon","label"]),(0,n.Wm)(i,{size:"sm",clickable:"",class:"glossy",icon:"mdi-map-marker",label:"Mapa"})])),_:1})])),_:1})}}});var W=l(2857),Z=l(7691);const Q=V,x=Q;h()(V,"components",{QCard:s.Z,QCardSection:m.Z,QIcon:W.Z,QCardActions:v.Z,QChip:Z.Z});var C=function(e,a,l,n){function t(e){return e instanceof l?e:new l((function(a){a(e)}))}return new(l||(l=Promise))((function(l,o){function u(e){try{r(n.next(e))}catch(a){o(a)}}function i(e){try{r(n["throw"](e))}catch(a){o(a)}}function r(e){e.done?l(e.value):t(e.value).then(u,i)}r((n=n.apply(e,a||[])).next())}))};const U=(0,n.aZ)({emits:["search"],setup(e,{emit:a}){const l=(0,u.Ey)(u.cH),r=(0,t.iH)({mode:"user",search:""});function c(){return C(this,void 0,void 0,(function*(){try{a("search",(yield l.search(r.value)).data.data)}catch(e){o.j7.axiosError(e,"Error en la busqueda")}}))}return(e,a)=>{const l=(0,n.up)("q-toggle"),t=(0,n.up)("q-btn"),o=(0,n.up)("q-input"),u=(0,n.up)("q-card-section"),s=(0,n.up)("q-form"),d=(0,n.up)("q-card");return(0,n.wg)(),(0,n.j4)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(s,{onSubmit:(0,i.iM)(c,["prevent"])},{default:(0,n.w5)((()=>[(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[(0,n.Wm)(l,{modelValue:r.value.mode,"onUpdate:modelValue":a[0]||(a[0]=e=>r.value.mode=e),"true-value":"user","false-value":"nick",color:"green",label:"user"===r.value.mode?"Buscar por Usuario":"Buscar por Nick"},null,8,["modelValue","label"]),"user"===r.value.mode?((0,n.wg)(),(0,n.j4)(o,{key:0,modelValue:r.value.search,"onUpdate:modelValue":a[1]||(a[1]=e=>r.value.search=e),type:"search",placeholder:"Nombre/Email","bg-color":"white",outlined:"",required:"",dense:""},{after:(0,n.w5)((()=>[(0,n.Wm)(t,{icon:"mdi-magnify",color:"primary",dense:"","aria-label":"Search",type:"submit",onClick:c})])),_:1},8,["modelValue"])):((0,n.wg)(),(0,n.j4)(o,{key:1,modelValue:r.value.search,"onUpdate:modelValue":a[2]||(a[2]=e=>r.value.search=e),type:"search",placeholder:"Nick de Agente","bg-color":"white",outlined:"",dense:"",required:""},{after:(0,n.w5)((()=>[(0,n.Wm)(t,{icon:"mdi-magnify",color:"primary",dense:"","aria-label":"Search",type:"submit",onClick:c})])),_:1},8,["modelValue"]))])),_:1})])),_:1},8,["onSubmit"])])),_:1})}}});var E=l(3175);const S=U,j=S;h()(U,"components",{QCard:s.Z,QForm:d.Z,QCardSection:m.Z,QToggle:E.Z,QInput:g.Z,QBtn:f.Z});var H=function(e,a,l,n){function t(e){return e instanceof l?e:new l((function(a){a(e)}))}return new(l||(l=Promise))((function(l,o){function u(e){try{r(n.next(e))}catch(a){o(a)}}function i(e){try{r(n["throw"](e))}catch(a){o(a)}}function r(e){e.done?l(e.value):t(e.value).then(u,i)}r((n=n.apply(e,a||[])).next())}))};const A=(0,n._)("div",{class:"text-h6 text-center"},"Administrar Agentes",-1),D={class:"text-subtitle2"},F={class:"row q-col-gutter-sm"},P=(0,n.aZ)({setup(e){const a=(0,u.Ey)(u.cH),l=(0,u.Ey)(u.Tc),i=(0,n.Fl)((()=>a.agents)),r=(0,t.iH)(!1),c=(0,t.iH)(!1),s=(0,t.iH)(),d=(0,t.iH)();function m(){d.value=void 0,s.value=void 0,r.value=!1,c.value=!1}function p(e){s.value=e}function g(e){return H(this,void 0,void 0,(function*(){Promise.all([a.list(),a.listGroup(),l.list()]).catch((e=>{o.j7.axiosError(e,"Error cargando datos")})).finally((()=>{e()}))}))}function v(e){const a=i.value.findIndex((a=>a.id===e));a>=0&&(d.value=i.value[a]),r.value=!0}function f(){m(),c.value=!0}return(0,n.wF)((()=>{g((()=>{console.log("Agent Page")}))})),(e,a)=>{const l=(0,n.up)("q-btn"),o=(0,n.up)("q-card-section"),u=(0,n.up)("q-card"),g=(0,n.up)("q-dialog"),y=(0,n.up)("q-page");return(0,n.wg)(),(0,n.j4)(y,{padding:""},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{class:"no-box-shadow"},{default:(0,n.w5)((()=>[(0,n.Wm)(o,{class:"q-gutter-y-sm"},{default:(0,n.w5)((()=>[A,(0,n._)("div",D,[(0,n.Wm)(l,{color:"primary",class:"full-width",icon:"mdi-magnify",label:"Buscar Agente",onClick:f})])])),_:1}),(0,n.Wm)(o,null,{default:(0,n.w5)((()=>[(0,n._)("div",F,[s.value&&s.value.length?((0,n.wg)(!0),(0,n.iD)(n.HY,{key:0},(0,n.Ko)(s.value,((e,a)=>((0,n.wg)(),(0,n.iD)("div",{class:"col-xs-12 col-sm-6 col-md-4 col-lg-3",key:`agent-${e.id}-k${a}`},[(0,n.Wm)(x,{agent:e,onRequestEdit:a=>v(e.id)},null,8,["agent","onRequestEdit"])])))),128)):((0,n.wg)(!0),(0,n.iD)(n.HY,{key:1},(0,n.Ko)((0,t.SU)(i),((e,a)=>((0,n.wg)(),(0,n.iD)("div",{class:"col-xs-12 col-sm-6 col-md-4 col-lg-3",key:`agent-${e.id}-k${a}`},[(0,n.Wm)(x,{agent:e,onRequestEdit:a=>v(e.id)},null,8,["agent","onRequestEdit"])])))),128))])])),_:1})])),_:1}),(0,n.Wm)(g,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=e=>r.value=e)},{default:(0,n.w5)((()=>[(0,n.Wm)(b,{agent:d.value,onCancel:m,onComplete:m,style:{"min-width":"20rem"}},null,8,["agent"])])),_:1},8,["modelValue"]),(0,n.Wm)(g,{modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=e=>c.value=e)},{default:(0,n.w5)((()=>[(0,n.Wm)(j,{style:{"min-width":"20rem"},onSearch:p})])),_:1},8,["modelValue"])])),_:1})}}});var B=l(699),N=l(9885),R=l(2074);const I=P,T=I;h()(P,"components",{QPullToRefresh:B.Z,QPage:N.Z,QCard:s.Z,QCardSection:m.Z,QBtn:f.Z,QDialog:R.Z})}}]);